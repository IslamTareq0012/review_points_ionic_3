{"version":3,"sources":["../../src/pages/edit-profile/edit-profile.module.ts","../../src/pages/edit-profile/edit-profile.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { EditProfilePage } from './edit-profile';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    EditProfilePage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(EditProfilePage),\r\n  ],\r\n})\r\nexport class EditProfilePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/edit-profile/edit-profile.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, AlertController, ToastController } from 'ionic-angular';\r\nimport { ProfileProvider } from '../../providers/profile/profile'\r\nimport { AuthProvider } from '../../providers/auth/auth';\r\nimport { NativeStorage } from '@ionic-native/native-storage';\r\nimport { User } from '../../Models/userModel';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/observable/fromPromise';\r\nimport { ImagePicker } from '@ionic-native/image-picker';\r\nimport { FCM } from '@ionic-native/fcm';\r\n\r\nimport { TabsPage } from '../tabs/tabs';\r\n\r\n/**\r\n * Generated class for the EditProfilePage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-edit-profile',\r\n  templateUrl: 'edit-profile.html',\r\n})\r\nexport class EditProfilePage {\r\n  tabBarElement: any;\r\n  profileData = false;\r\n  userData: any;\r\n  email;\r\n  password;\r\n  confirmPassword;\r\n  name;\r\n  myDate;\r\n  userImage = null;\r\n  imageUrl;\r\n  tempImageUrl;\r\n  constructor(public fcm: FCM, private imagePicker: ImagePicker, private toastCtrl: ToastController, private profileProvider: ProfileProvider, private nativeStorage: NativeStorage, public navCtrl: NavController, public navParams: NavParams, private authProvider: AuthProvider, private alertCtrl: AlertController) {\r\n    this.userData = {} as User;\r\n    this.userData = this.navParams.data;\r\n    this.imageUrl = \"http://localhost:3000/images/\" + this.userData.userImage;\r\n    this.tempImageUrl = \"http://localhost:3000/images/\" + this.userData.userImage;\r\n    console.log(\"user data to edit\", this.userData);\r\n    if (this.userData == null) {\r\n      console.log(\"RegisterPage\", this.userData)\r\n      this.profileData = false;\r\n    }\r\n    else {\r\n      console.log(\"EditProfilePage\", this.userData)\r\n      this.profileData = true\r\n    }\r\n  }\r\n\r\n\r\n  ionViewWillEnter() {\r\n    if (this.profileData) {\r\n      this.tabBarElement.style.display = 'none';\r\n    }\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    if (this.profileData) {\r\n      this.tabBarElement.style.display = 'flex';\r\n    }\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad ProfilePage');\r\n    if (this.profileData) {\r\n      this.tabBarElement = document.querySelector('.tabbar.show-tabbar');\r\n      console.log(\"tabs element\", this.tabBarElement);\r\n    }\r\n\r\n  }\r\n  showToast() {\r\n    let toast = this.toastCtrl.create({\r\n      message: 'Kindly check your email for further instructions',\r\n      duration: 4000,\r\n      position: 'bottom'\r\n    });\r\n    toast.present();\r\n  }\r\n  resestPassword() {\r\n    var body = {\r\n      email: this.userData.email\r\n    }\r\n    this.authProvider.forgotPassword(body)\r\n      .then(res => {\r\n        this.showToast();\r\n      }).catch(err => {\r\n        console.log(\"error reset password\", err);\r\n      });\r\n  }\r\n\r\n  edit() {\r\n    if (this.tempImageUrl == this.imageUrl) {\r\n      console.log(\"user data to submit for edit\", this.userData);\r\n      var subscription = Observable.fromPromise(this.nativeStorage.getItem('token'));\r\n      subscription.subscribe(token => {\r\n        this.profileProvider.editUser(token.jwtUserToken, this.userData)\r\n          .then(res => {\r\n            console.log(\"edit user response\", res);\r\n            this.navCtrl.pop();\r\n          }).catch(err => {\r\n            console.log(\"edit user error\", err);\r\n          });\r\n      }, err => {\r\n        console.log(\"getting token error\", err);\r\n      });\r\n    } else if (this.tempImageUrl != this.userData.userImage) {\r\n      this.userData.userImage = this.tempImageUrl;\r\n    }\r\n  }\r\n\r\n  pickImage() {\r\n    let options = {\r\n      quality: 95,\r\n      width: 500,\r\n      height: 500,\r\n      maximumImagesCount: 1,\r\n      outputType: 1\r\n    }\r\n    this.imagePicker.getPictures(options)\r\n      .then((result) => {\r\n        this.imageUrl = \"data:image/jpeg;base64,\" + result[0].toString();\r\n        this.tempImageUrl = result[0].toString();\r\n      },\r\n      (err) => { console.log(err); });\r\n  }\r\n\r\n  signup() {\r\n    var emailForm = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    console.log(this.email)\r\n    console.log(this.name)\r\n    console.log(this.password)\r\n    console.log(this.confirmPassword)\r\n    console.log(this.myDate)\r\n\r\n    if (this.password == this.confirmPassword && emailForm.test(this.email) && (this.email && this.password && this.confirmPassword && this.myDate && this.name) != undefined) {\r\n      console.log(\"valid\")\r\n      //this.fcm.getToken().then(token => {\r\n      var cerdentials = {\r\n        email: this.email,\r\n        password: this.password,\r\n        resetPasswordToken: \"undefined\",\r\n        resetPasswordExpires: 0,\r\n        points: [],\r\n        notificationToken: \"N/A\",\r\n        fullName: this.name,\r\n        userImage: this.userImage\r\n      }\r\n      console.log(\"Card : \", cerdentials);\r\n      this.authProvider.SignUp(cerdentials).then((res) => {\r\n        console.log(\"Sign Up response\", res);\r\n        this.nativeStorage.setItem(\"token\", { jwtUserToken: res.token }).then((saved) => {\r\n          console.log(saved);\r\n          this.navCtrl.push(TabsPage);\r\n        }).catch(err => {\r\n          console.log(\"save token error\", err)\r\n        })\r\n      }).catch(err => {\r\n        console.log(\"SignUp error \", err);\r\n      });\r\n\r\n      //console.log(\"user firebase notification token\", token);\r\n      //});\r\n    } else {\r\n      console.log(\"Not Valid\")\r\n      let alert = this.alertCtrl.create({\r\n        title: 'Error',\r\n        subTitle: 'Check All Fields',\r\n        buttons: ['Ok']\r\n      });\r\n      alert.present();\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/edit-profile/edit-profile.ts"],"sourceRoot":""}