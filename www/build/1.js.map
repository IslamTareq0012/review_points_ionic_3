{"version":3,"sources":["../../src/pages/add-review/add-review.module.ts","../../src/pages/add-review/add-review.ts"],"names":[],"mappings":"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","file":"1.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { AddReviewPage } from './add-review';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddReviewPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(AddReviewPage),\r\n  ],\r\n})\r\nexport class AddReviewPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-review/add-review.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams,LoadingController,AlertController } from 'ionic-angular';\r\nimport { ProfileProvider } from '../../providers/profile/profile'\r\nimport { ReviewsProvider } from '../../providers/reviews/reviews'\r\nimport { NativeStorage } from '@ionic-native/native-storage';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport 'rxjs/add/observable/fromPromise';\r\n\r\nimport { User } from '../../Models/userModel';\r\nimport { Review } from '../../Models/reviewModel';\r\n/**\r\n * Generated class for the AddReviewPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-add-review',\r\n  templateUrl: 'add-review.html',\r\n})\r\nexport class AddReviewPage {\r\n  invoiceID;\r\n  productName;\r\n  productModel;\r\n  siteID;\r\n  siteArray=[];\r\n  siteName;\r\n  categoryID;\r\n  categoryArray=[]\r\n  categoryBool = false;\r\n  review;\r\n  reviewData={};\r\n  sentiment;\r\n  userData = {} as User;\r\n  loading = null;\r\n  userToken;\r\n  userID:number;\r\n  detectText:string;\r\n  constructor(private nativeStorage: NativeStorage, public navCtrl: NavController, private profileProvider: ProfileProvider,private reviewProvider:ReviewsProvider, public loadingCtrl: LoadingController,private alertCtrl:AlertController) {\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n\r\n\r\n    console.log('ionViewDidLoad AddReviewPage');\r\n    this.showLoading();\r\n    var subscription = Observable.fromPromise(this.nativeStorage.getItem('token'));\r\n    subscription.subscribe(token => {\r\n      console.log(\"token from observable\", token.jwtUserToken);\r\n      this.profileProvider.getUser(token.jwtUserToken).then(res => {\r\n        this.userData = res._id;\r\n        this.userID=res._id\r\n        this.userToken=token.jwtUserToken\r\n        console.log(\"User ID\" ,this.userID)\r\n        this.reviewProvider.GetSites().then(res => {\r\n          console.log(res);\r\n          this.siteArray = res;\r\n        }).catch(err => {\r\n          console.log(err)\r\n        });\r\n        this.dismissLoading();\r\n      }).catch(err => {\r\n        console.log(\"error getting user\", err);\r\n      });\r\n    },\r\n      error => {\r\n        console.log(\"no token\", error);\r\n      });\r\n     \r\n  }\r\n\r\n  setSiteValue(siteID){\r\n    console.log(siteID);\r\n    if(siteID){\r\n    this.categoryBool=true\r\n    this.showLoading()\r\n    this.reviewProvider.GetCategories(siteID).then(res =>{\r\n      console.log(res);\r\n      this.categoryArray=res;\r\n      this.dismissLoading();\r\n    }).catch(err =>{\r\n      console.log(err)\r\n    })\r\n  }else{\r\n    this.categoryBool = false;\r\n  }\r\n}\r\n\r\n  CheckLanguage(){\r\n    this.showLoading()\r\n    this.reviewProvider.DetectLanguage(this.review).then(res => {\r\n      this.detectText = res.language;\r\n      console.log(\"Language is \" ,this.detectText)\r\n      this.reviewProvider.GetSentiment(this.review,this.detectText).then(res => {\r\n        this.showLoading();\r\n         \r\n         if (this.detectText=='en'){\r\n          this.sentiment=res.probability.pos\r\n          console.log(\"Score is \" ,this.sentiment)\r\n         }else if (this.detectText =='ar'){\r\n           this.sentiment = res.score;\r\n          console.log(\"Score is \" ,this.sentiment);\r\n         }else {\r\n          let alert = this.alertCtrl.create({\r\n            title: 'Error',\r\n            subTitle: 'Cannot Define your language please write on Arabic or English',\r\n            buttons: ['Ok']\r\n          });\r\n          alert.present();\r\n         }\r\n         for (let i=0;i<this.siteArray.length;i++){\r\n          if (this.siteID == this.siteArray[i]._id){\r\n            console.log(this.siteArray[i].siteName);\r\n            this.siteName=this.siteArray[i].siteName\r\n            break;\r\n          }\r\n         }\r\n         this.reviewData = {\r\n          \"invoiceID\": this.invoiceID,\r\n          \"productName\":this.productName,\r\n         \"category\":this.categoryID,\r\n         \"productModel\": this.productModel,\r\n         \"review\": this.review,\r\n         \"site\" : this.siteName,\r\n         \"user\": this.userID,\r\n         \"sentiment\":this.sentiment\r\n         }\r\n         console.log(this.reviewData);\r\n          this.reviewProvider.AddReview(this.reviewData,this.userToken).then(res => {\r\n            console.log(res)\r\n            let alert = this.alertCtrl.create({\r\n              title: 'Alert',\r\n              subTitle: 'Thanks for your review',\r\n              buttons: [\r\n                {text: 'Ok' ,\r\n\t  \t          handler: () => {\r\n                  this.navCtrl.pop();\r\n              }}]\r\n            });\r\n            alert.present();\r\n            this.dismissLoading();\r\n          }).catch(err => {\r\n            let alert = this.alertCtrl.create({\r\n              title: 'Error',\r\n              subTitle: 'Sorry please try again Later',\r\n              buttons: ['Ok']\r\n            });\r\n            alert.present();\r\n             console.log(\"error adding Review \", err);    \r\n          })\r\n       }).catch(err => {\r\n        let alert = this.alertCtrl.create({\r\n          title: 'Error',\r\n          subTitle: 'Cannot Get score of sentiment',\r\n          buttons: ['Ok']\r\n        });\r\n        alert.present();\r\n         console.log(\"error getting score \", err);\r\n       });\r\n    }).catch(err => {\r\n      let alert = this.alertCtrl.create({\r\n        title: 'Error',\r\n        subTitle: 'Cannot Define your language please write on Arabic or English',\r\n        buttons: ['Ok']\r\n      });\r\n      alert.present();\r\n      this.dismissLoading()\r\n      console.log(\"error detecting Language\", err);\r\n    });\r\n}\r\n\r\n  \r\n  AddReview(){\r\n    console.log(this.detectText);\r\n    console.log(\"ssss0\",this.CheckLanguage());\r\n    console.log(this.sentiment);\r\n    console.log(this.invoiceID);\r\n    console.log(this.productModel);\r\n    console.log(this.productName);\r\n    console.log(this.siteID);\r\n    console.log(this.categoryID);\r\n    console.log(this.review);\r\n  }\r\n  showLoading() {\r\n    if (!this.loading) {\r\n      this.loading = this.loadingCtrl.create({\r\n        spinner: 'dots',\r\n        content: 'Loading...'\r\n      });\r\n      this.loading.present();\r\n    }\r\n  }\r\n  dismissLoading() {\r\n    if (this.loading) {\r\n      this.loading.dismiss();\r\n      this.loading = null;\r\n    }\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-review/add-review.ts"],"sourceRoot":""}